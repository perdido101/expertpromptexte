<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ExpertPrompt</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <div id="app">
    <!-- Header -->
    <header class="header">
      <div class="header-left">
        <div class="header-icon">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="12" cy="8" r="4" stroke="currentColor" stroke-width="2"/>
            <path d="M4 20C4 16.6863 7.13401 14 11 14H13C16.866 14 20 16.6863 20 20" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </div>
        <h1 class="header-title">ExpertPrompt</h1>
      </div>
      <button id="settings-btn" class="icon-btn" title="Settings">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="3"/><path d="M12 1v4M12 19v4M4.22 4.22l2.83 2.83M16.95 16.95l2.83 2.83M1 12h4M19 12h4M4.22 19.78l2.83-2.83M16.95 7.05l2.83-2.83"/>
        </svg>
      </button>
    </header>

    <!-- Settings Panel (hidden by default) -->
    <div id="settings-panel" class="settings-panel hidden">
      <div class="settings-header">
        <span>Settings</span>
        <button id="close-settings" class="icon-btn-sm">&times;</button>
      </div>
      <div class="settings-content">
        <label class="toggle-row">
          <span>Auto-add guardrails for sensitive roles</span>
          <input type="checkbox" id="guardrails-toggle" checked>
          <span class="toggle-slider"></span>
        </label>
        <p class="settings-note">All data is stored locally in your browser. No network calls.</p>
      </div>
    </div>

    <!-- Search Section -->
    <div class="search-section">
      <div class="search-input-wrapper">
        <input type="text" id="role-input" class="search-input" placeholder="Search expert role..." autocomplete="off" spellcheck="false"/>
        <button id="clear-btn" class="clear-btn hidden" type="button" aria-label="Clear">&times;</button>
      </div>
      <div id="suggestions" class="suggestions hidden"></div>
    </div>

    <!-- Role Chain Section (collapsible) -->
    <div id="chain-section" class="collapsible-section">
      <button class="section-header" data-toggle="chain-content">
        <span>Role Chain</span>
        <span class="chain-count hidden" id="chain-count">0</span>
        <svg class="chevron" width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M4 6l4 4 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
      </button>
      <div id="chain-content" class="section-content hidden">
        <div id="chain-list" class="chain-list"></div>
        <button id="add-to-chain" class="btn-secondary btn-sm" disabled>+ Add selected role to chain</button>
      </div>
    </div>

    <!-- Task/Context Section (collapsible) -->
    <div id="context-section" class="collapsible-section">
      <button class="section-header" data-toggle="context-content">
        <span>Task & Context</span>
        <svg class="chevron" width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M4 6l4 4 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
      </button>
      <div id="context-content" class="section-content hidden">
        <div class="field-group">
          <label for="task-input">Task / Goal</label>
          <input type="text" id="task-input" class="field-input" placeholder="e.g., Review my landing page copy">
        </div>
        <div class="field-group">
          <label for="context-input">Context</label>
          <textarea id="context-input" class="field-textarea" rows="2" placeholder="e.g., B2B SaaS, targeting CTOs"></textarea>
        </div>
        <div class="field-group">
          <label for="output-format-input">Output Format</label>
          <input type="text" id="output-format-input" class="field-input" placeholder="e.g., Bullet points, max 5 items">
        </div>
      </div>
    </div>

    <!-- Mode & Constraints Section -->
    <div id="constraints-section" class="collapsible-section">
      <button class="section-header" data-toggle="constraints-content">
        <span>Mode & Constraints</span>
        <svg class="chevron" width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M4 6l4 4 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
      </button>
      <div id="constraints-content" class="section-content hidden">
        <div class="field-group">
          <label for="mode-select">Mode</label>
          <select id="mode-select" class="field-select">
            <option value="default">Default</option>
            <option value="absolute">Absolute (blunt, no fluff)</option>
            <option value="collaborative">Collaborative (asks questions first)</option>
            <option value="executive">Executive Summary</option>
          </select>
        </div>
        <div class="constraints-grid">
          <label class="constraint-toggle"><input type="checkbox" id="c-no-questions"><span>No questions</span></label>
          <label class="constraint-toggle"><input type="checkbox" id="c-no-emojis"><span>No emojis</span></label>
          <label class="constraint-toggle"><input type="checkbox" id="c-bullets"><span>Bullet points only</span></label>
          <label class="constraint-toggle"><input type="checkbox" id="c-concise"><span>Ultra concise</span></label>
          <label class="constraint-toggle"><input type="checkbox" id="c-stepbystep"><span>Step-by-step</span></label>
          <label class="constraint-toggle"><input type="checkbox" id="c-risks"><span>Include risks</span></label>
        </div>
        <div id="first-output-group" class="field-group hidden">
          <label for="first-output-input">First output should be...</label>
          <input type="text" id="first-output-input" class="field-input" placeholder="e.g., A summary of key points">
        </div>
        <label class="constraint-toggle mt-sm"><input type="checkbox" id="c-first-output"><span>Specify first output</span></label>
      </div>
    </div>

    <!-- Guardrails Notice -->
    <div id="sensitive-disclaimer" class="disclaimer hidden">
      <svg width="14" height="14" viewBox="0 0 16 16" fill="none"><circle cx="8" cy="8" r="7" stroke="currentColor" stroke-width="1.5"/><path d="M8 5V8.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><circle cx="8" cy="11" r="0.75" fill="currentColor"/></svg>
      <span>Guardrail added: informational only disclaimer.</span>
    </div>

    <!-- Prompt Preview -->
    <div id="prompt-panel" class="prompt-panel hidden">
      <div class="prompt-header">
        <span>Generated Prompt</span>
        <label class="edit-toggle"><input type="checkbox" id="edit-toggle"><span>Edit</span></label>
      </div>
      <div id="prompt-content" class="prompt-content"></div>
      <textarea id="prompt-editor" class="prompt-editor hidden"></textarea>
    </div>

    <!-- Empty State -->
    <div id="empty-state" class="empty-state">
      <p class="helper-text">Search and select a role to generate your prompt.</p>
    </div>

    <!-- Actions Row -->
    <div class="actions-row">
      <button id="copy-btn" class="btn-primary" disabled>
        <span class="btn-text">Copy</span>
        <span class="btn-success hidden">Copied!</span>
      </button>
      <button id="save-preset-btn" class="btn-secondary" disabled>Save</button>
      <button id="export-btn" class="btn-secondary" disabled>Export</button>
    </div>

    <!-- Export Menu -->
    <div id="export-menu" class="dropdown-menu hidden">
      <button data-format="txt">Export as .txt</button>
      <button data-format="md">Export as .md</button>
    </div>

    <!-- Bottom Tabs -->
    <div class="bottom-tabs">
      <button class="tab-btn active" data-tab="presets">Presets</button>
      <button class="tab-btn" data-tab="history">History</button>
    </div>

    <!-- Presets Tab -->
    <div id="presets-tab" class="tab-content">
      <div id="presets-list" class="presets-list">
        <p class="empty-list-msg">No saved presets yet.</p>
      </div>
    </div>

    <!-- History Tab -->
    <div id="history-tab" class="tab-content hidden">
      <div id="history-list" class="history-list">
        <p class="empty-list-msg">No prompt history yet.</p>
      </div>
    </div>

    <!-- Save Preset Modal -->
    <div id="save-modal" class="modal hidden">
      <div class="modal-content">
        <div class="modal-header">
          <span>Save Preset</span>
          <button id="close-modal" class="icon-btn-sm">&times;</button>
        </div>
        <div class="modal-body">
          <div class="field-group">
            <label for="preset-name-input">Preset Name</label>
            <input type="text" id="preset-name-input" class="field-input" placeholder="e.g., My Marketing Setup">
          </div>
          <label class="constraint-toggle"><input type="checkbox" id="set-default-checkbox"><span>Set as default</span></label>
        </div>
        <div class="modal-footer">
          <button id="cancel-save" class="btn-secondary">Cancel</button>
          <button id="confirm-save" class="btn-primary">Save</button>
        </div>
      </div>
    </div>
  </div>

  <script src="popup.js"></script>
</body>
</html>
